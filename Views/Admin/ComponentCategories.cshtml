@model IEnumerable<OneJevelsCompany.Web.Controllers.ComponentCategoriesController.CategoryRowVm>
@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Component Categories";
    var list = (Model ?? Enumerable.Empty<OneJevelsCompany.Web.Controllers.ComponentCategoriesController.CategoryRowVm>())
               .OrderBy(c => c.SortOrder)
               .ThenBy(c => c.Name)
               .ToList();
}
@if (TempData["ok"] is string ok && !string.IsNullOrWhiteSpace(ok))
{
    <div class="mb-4 p-3 rounded border border-green-200 bg-green-50 text-green-800">@ok</div>
}
@if (TempData["err"] is string err && !string.IsNullOrWhiteSpace(err))
{
    <div class="mb-4 p-3 rounded border border-rose-200 bg-rose-50 text-rose-800">@err</div>
}

@if (!list.Any())
{
    <div class="bg-white rounded-2xl shadow p-6 text-gray-700">
        No categories yet. Use the sidebar <b>New Category</b> to create your first one.
    </div>
}
else
{
    <div class="bg-white rounded-2xl shadow overflow-hidden">
        <table class="min-w-full text-left">
            <thead class="bg-gray-50 text-sm text-gray-600">
                <tr>
                    <th class="px-4 py-2">Sort</th>
                    <th class="px-4 py-2">Name</th>
                    <th class="px-4 py-2"># Components</th>
                    <th class="px-4 py-2 w-40"></th>
                </tr>
            </thead>
            <tbody class="text-sm">
                @foreach (var c in list)
                {
                    <tr class="border-t hover:bg-amber-50/40">
                        <td class="px-4 py-2">@c.SortOrder</td>
                        <td class="px-4 py-2">@c.Name</td>
                        <td class="px-4 py-2">@c.Components</td>
                        <td class="px-4 py-2">
                            <div class="flex gap-2">
                                <a asp-controller="ComponentCategories" asp-action="Edit" asp-route-id="@c.Id"
                                   class="px-3 py-1 rounded bg-amber-600 text-white hover:bg-amber-500">Edit</a>
                                <form asp-controller="ComponentCategories" asp-action="Delete" asp-route-id="@c.Id" method="post"
                                      onsubmit="return confirm('Delete category “@c.Name”? This cannot be undone.');">
                                    @Html.AntiForgeryToken()
                                    <button type="submit" class="px-3 py-1 rounded border hover:bg-gray-50">Delete</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
